<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Terraform | MLOps Architecture from scratch</title>
  <meta name="description" content="This is a tutorial to build a MLOps Airflow architecture utilizing K8s, Terraform, MLFlow, and DVC." />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Terraform | MLOps Architecture from scratch" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a tutorial to build a MLOps Airflow architecture utilizing K8s, Terraform, MLFlow, and DVC." />
  <meta name="github-repo" content="seblum/mlops-practice" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Terraform | MLOps Architecture from scratch" />
  
  <meta name="twitter:description" content="This is a tutorial to build a MLOps Airflow architecture utilizing K8s, Terraform, MLFlow, and DVC." />
  

<meta name="author" content="Sebastian Blum" />


<meta name="date" content="2022-10-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="architecture.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#topics"><i class="fa fa-check"></i>Topics</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#a-work-in-progress"><i class="fa fa-check"></i>A work in progress</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="terraform.html"><a href="terraform.html"><i class="fa fa-check"></i><b>3</b> Terraform</a>
<ul>
<li class="chapter" data-level="3.1" data-path="terraform.html"><a href="terraform.html#prerequisites"><i class="fa fa-check"></i><b>3.1</b> Prerequisites</a></li>
<li class="chapter" data-level="3.2" data-path="terraform.html"><a href="terraform.html#basic-usage-commands"><i class="fa fa-check"></i><b>3.2</b> Basic usage &amp; commands</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="terraform.html"><a href="terraform.html#terraform-init"><i class="fa fa-check"></i><b>3.2.1</b> terraform init</a></li>
<li class="chapter" data-level="3.2.2" data-path="terraform.html"><a href="terraform.html#terraform-validate"><i class="fa fa-check"></i><b>3.2.2</b> terraform validate</a></li>
<li class="chapter" data-level="3.2.3" data-path="terraform.html"><a href="terraform.html#terraform-plan"><i class="fa fa-check"></i><b>3.2.3</b> terraform plan</a></li>
<li class="chapter" data-level="3.2.4" data-path="terraform.html"><a href="terraform.html#terraform-apply"><i class="fa fa-check"></i><b>3.2.4</b> terraform apply</a></li>
<li class="chapter" data-level="3.2.5" data-path="terraform.html"><a href="terraform.html#terraform-destroy"><i class="fa fa-check"></i><b>3.2.5</b> terraform destroy</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="terraform.html"><a href="terraform.html#core-concepts"><i class="fa fa-check"></i><b>3.3</b> Core Concepts</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="terraform.html"><a href="terraform.html#state"><i class="fa fa-check"></i><b>3.3.1</b> State</a></li>
<li class="chapter" data-level="3.3.2" data-path="terraform.html"><a href="terraform.html#providers"><i class="fa fa-check"></i><b>3.3.2</b> providers</a></li>
<li class="chapter" data-level="3.3.3" data-path="terraform.html"><a href="terraform.html#resources"><i class="fa fa-check"></i><b>3.3.3</b> Resources</a></li>
<li class="chapter" data-level="3.3.4" data-path="terraform.html"><a href="terraform.html#data-sources"><i class="fa fa-check"></i><b>3.3.4</b> Data Sources</a></li>
<li class="chapter" data-level="3.3.5" data-path="terraform.html"><a href="terraform.html#input-variables"><i class="fa fa-check"></i><b>3.3.5</b> Input Variables</a></li>
<li class="chapter" data-level="3.3.6" data-path="terraform.html"><a href="terraform.html#output-variables"><i class="fa fa-check"></i><b>3.3.6</b> Output Variables</a></li>
<li class="chapter" data-level="3.3.7" data-path="terraform.html"><a href="terraform.html#local-variables"><i class="fa fa-check"></i><b>3.3.7</b> Local Variables</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="terraform.html"><a href="terraform.html#modules"><i class="fa fa-check"></i><b>3.4</b> Modules</a></li>
<li class="chapter" data-level="3.5" data-path="terraform.html"><a href="terraform.html#language"><i class="fa fa-check"></i><b>3.5</b> Language</a></li>
<li class="chapter" data-level="3.6" data-path="terraform.html"><a href="terraform.html#additionals"><i class="fa fa-check"></i><b>3.6</b> additionals</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="terraform.html"><a href="terraform.html#count-and-for_each-meta-arguments"><i class="fa fa-check"></i><b>3.6.1</b> count and for_each Meta Arguments</a></li>
<li class="chapter" data-level="3.6.2" data-path="terraform.html"><a href="terraform.html#workspaces"><i class="fa fa-check"></i><b>3.6.2</b> workspaces</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="terraform.html"><a href="terraform.html#full-example---building-ec2-and-s3"><i class="fa fa-check"></i><b>3.7</b> Full example - building ec2 and s3</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="architecture.html"><a href="architecture.html"><i class="fa fa-check"></i><b>4</b> Architecture</a>
<ul>
<li class="chapter" data-level="4.1" data-path="architecture.html"><a href="architecture.html#airflow"><i class="fa fa-check"></i><b>4.1</b> Airflow</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="architecture.html"><a href="architecture.html#rds"><i class="fa fa-check"></i><b>4.1.1</b> RDS</a></li>
<li class="chapter" data-level="4.1.2" data-path="architecture.html"><a href="architecture.html#github-sync"><i class="fa fa-check"></i><b>4.1.2</b> Github Sync</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="architecture.html"><a href="architecture.html#mlflow"><i class="fa fa-check"></i><b>4.2</b> MLFlow</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="architecture.html"><a href="architecture.html#airflow-integration"><i class="fa fa-check"></i><b>4.2.1</b> Airflow integration</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="architecture.html"><a href="architecture.html#eks-cluster"><i class="fa fa-check"></i><b>4.3</b> EKS Cluster</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="architecture.html"><a href="architecture.html#user-management"><i class="fa fa-check"></i><b>4.3.1</b> User Management</a></li>
<li class="chapter" data-level="4.3.2" data-path="architecture.html"><a href="architecture.html#monitoring"><i class="fa fa-check"></i><b>4.3.2</b> Monitoring</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="architecture.html"><a href="architecture.html#deployment"><i class="fa fa-check"></i><b>4.4</b> Deployment</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="kubernetes.html"><a href="kubernetes.html"><i class="fa fa-check"></i><b>5</b> Kubernetes</a>
<ul>
<li class="chapter" data-level="5.1" data-path="kubernetes.html"><a href="kubernetes.html#prerequisites-1"><i class="fa fa-check"></i><b>5.1</b> Prerequisites</a></li>
<li class="chapter" data-level="5.2" data-path="kubernetes.html"><a href="kubernetes.html#nodes"><i class="fa fa-check"></i><b>5.2</b> Nodes</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="kubernetes.html"><a href="kubernetes.html#master-control-plane"><i class="fa fa-check"></i><b>5.2.1</b> Master &amp; Control Plane</a></li>
<li class="chapter" data-level="5.2.2" data-path="kubernetes.html"><a href="kubernetes.html#worker-nodes"><i class="fa fa-check"></i><b>5.2.2</b> Worker Nodes</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="kubernetes.html"><a href="kubernetes.html#pods"><i class="fa fa-check"></i><b>5.3</b> Pods</a>
<ul>
<li class="chapter" data-level="" data-path="kubernetes.html"><a href="kubernetes.html#imperative-declarative-management"><i class="fa fa-check"></i>Imperative &amp; Declarative Management</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="kubernetes.html"><a href="kubernetes.html#deployments"><i class="fa fa-check"></i><b>5.4</b> Deployments</a></li>
<li class="chapter" data-level="5.5" data-path="kubernetes.html"><a href="kubernetes.html#services"><i class="fa fa-check"></i><b>5.5</b> Services</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="kubernetes.html"><a href="kubernetes.html#exemplary-setup-of-database-and-frontend-microservices"><i class="fa fa-check"></i><b>5.5.1</b> Exemplary setup of database and frontend microservices</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="kubernetes.html"><a href="kubernetes.html#labels-selectors-and-annotations"><i class="fa fa-check"></i><b>5.6</b> Labels, Selectors and Annotations</a></li>
<li class="chapter" data-level="5.7" data-path="kubernetes.html"><a href="kubernetes.html#namespaces"><i class="fa fa-check"></i><b>5.7</b> Namespaces</a></li>
<li class="chapter" data-level="5.8" data-path="kubernetes.html"><a href="kubernetes.html#service-discovery"><i class="fa fa-check"></i><b>5.8</b> Service Discovery</a></li>
<li class="chapter" data-level="5.9" data-path="kubernetes.html"><a href="kubernetes.html#volume-storage"><i class="fa fa-check"></i><b>5.9</b> Volume &amp; Storage</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="kubernetes.html"><a href="kubernetes.html#emptydir-volume"><i class="fa fa-check"></i><b>5.9.1</b> EmptyDir Volume</a></li>
<li class="chapter" data-level="5.9.2" data-path="kubernetes.html"><a href="kubernetes.html#hostpath-volume"><i class="fa fa-check"></i><b>5.9.2</b> HostPath Volume</a></li>
<li class="chapter" data-level="5.9.3" data-path="kubernetes.html"><a href="kubernetes.html#persistent-volumes"><i class="fa fa-check"></i><b>5.9.3</b> Persistent Volumes</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="kubernetes.html"><a href="kubernetes.html#configmaps"><i class="fa fa-check"></i><b>5.10</b> ConfigMaps</a></li>
<li class="chapter" data-level="5.11" data-path="kubernetes.html"><a href="kubernetes.html#secrets"><i class="fa fa-check"></i><b>5.11</b> Secrets</a>
<ul>
<li class="chapter" data-level="5.11.1" data-path="kubernetes.html"><a href="kubernetes.html#exemplary-use-case-of-secrets"><i class="fa fa-check"></i><b>5.11.1</b> Exemplary use case of secrets</a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="kubernetes.html"><a href="kubernetes.html#health-checks"><i class="fa fa-check"></i><b>5.12</b> Health Checks</a>
<ul>
<li class="chapter" data-level="5.12.1" data-path="kubernetes.html"><a href="kubernetes.html#liveness-probe"><i class="fa fa-check"></i><b>5.12.1</b> Liveness Probe</a></li>
<li class="chapter" data-level="5.12.2" data-path="kubernetes.html"><a href="kubernetes.html#readiness-probe"><i class="fa fa-check"></i><b>5.12.2</b> Readiness Probe</a></li>
</ul></li>
<li class="chapter" data-level="5.13" data-path="kubernetes.html"><a href="kubernetes.html#resource-management"><i class="fa fa-check"></i><b>5.13</b> Resource Management</a></li>
<li class="chapter" data-level="5.14" data-path="kubernetes.html"><a href="kubernetes.html#deamon-sets"><i class="fa fa-check"></i><b>5.14</b> Deamon Sets</a></li>
<li class="chapter" data-level="5.15" data-path="kubernetes.html"><a href="kubernetes.html#statefulsets"><i class="fa fa-check"></i><b>5.15</b> StatefulSets</a></li>
<li class="chapter" data-level="5.16" data-path="kubernetes.html"><a href="kubernetes.html#jobs-cron-jobs"><i class="fa fa-check"></i><b>5.16</b> Jobs &amp; Cron Jobs</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MLOps Architecture from scratch</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="terraform" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Terraform<a href="terraform.html#terraform" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Terraform is an infrastructure as code (IaC) tool that allows you to build, change, and version infrastructure safely and efficiently. This includes both low-level components like compute instances, storage, and networking, as well as high-level components like DNS entries and SaaS features. <span class="citation">(<a href="#ref-hashicorpwebsite" role="doc-biblioref"><strong>hashicorpwebsite?</strong></a>)</span> (<a href="https://www.terraform.io/docs" class="uri">https://www.terraform.io/docs</a>)</p>
<p>IaC means using machine-readable definition files to manage and provision an entire IT infrastructure. This can automate the whole IT infrastructure and allows faster execution when configuring infrastructure, as well as allows a full traceability of the changes. Of the several IaC tools in the market right today, Terraform is a well known and established IaC tool.</p>
<p>Terraform is developed by HashiCorp, open-source, and allows to create both on-prem and cloud resources. There are several differend hundred providers that can be used with Terraform, such as Amazon Web Services (AWS), Azure, Google Cloud Platform (GCP), Kubernetes, Helm, GitHub, Splunk, DataDog, etc.</p>
<p>We want to use Terraform to create our ressource needed for Airflow in an automated way.</p>
<div id="prerequisites" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Prerequisites<a href="terraform.html#prerequisites" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To be able to follow through this tutorial, one needs to have the AWS CLI installed as well as the AWS credentials set up. Further, Terraform itself needs to be installed. One can check its installation via <code>terraform version</code>.</p>
</div>
<div id="basic-usage-commands" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Basic usage &amp; commands<a href="terraform.html#basic-usage-commands" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A Terraform project is basically just a set of files in a directory containing resource definitions of the cloud ressources to be created. Those Terraform files, denoted by the ending <em>.tf</em>, use Terraform’s configuration language to define the specified resources. In the following example there are two definitions made: a <em>provider</em> and a <em>resource</em>. Later in this chapter we will dive deeper in the structure of the language. For now we only need to know this script is creating a file <em>hello.txt</em> which includes the text “Hello, Teraform”. It’s our Terraform version of Hello World!</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="terraform.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">provider</span> <span class="st">&quot;local&quot;</span> {</span>
<span id="cb1-2"><a href="terraform.html#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">version</span> = <span class="st">&quot;~&gt; 1.4&quot;</span></span>
<span id="cb1-3"><a href="terraform.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span>
<span id="cb1-4"><a href="terraform.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">resource</span> <span class="st">&quot;local_file&quot;</span> <span class="st">&quot;hello&quot;</span> {</span>
<span id="cb1-5"><a href="terraform.html#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="ex">content</span> = <span class="st">&quot;Hello, Terraform&quot;</span></span>
<span id="cb1-6"><a href="terraform.html#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="ex">filename</span> = <span class="st">&quot;hello.txt&quot;</span></span>
<span id="cb1-7"><a href="terraform.html#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span></code></pre></div>
<div id="terraform-init" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> terraform init<a href="terraform.html#terraform-init" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When a project is run for the first time the terraform project needs to be initialized. This is done via the <code>terraform init</code> command. Terraform scans the project files in this step and downloads any required providers needed (more to providers in the following). In the given example this is the local procider.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="terraform.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">terraform</span> init — Initializes the working directory which consists of all the configuration files</span></code></pre></div>
</div>
<div id="terraform-validate" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> terraform validate<a href="terraform.html#terraform-validate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>terraform validate</code> command checks the code for syntax errors. This is optional</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="terraform.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">terraform</span> validate — Validates the configuration files in a directory</span></code></pre></div>
</div>
<div id="terraform-plan" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> terraform plan<a href="terraform.html#terraform-plan" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>terraform plan</code> command verifies what action Terraform will perform and what resources will be created. This step is basically a <em>dry run</em> of the code to be executed. It also returns the provided values and some permission attributes which have been set.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="terraform.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">terraform</span> plan — Creates an execution plan to reach a desired state of the infrastructure</span></code></pre></div>
</div>
<div id="terraform-apply" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> terraform apply<a href="terraform.html#terraform-apply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The command <code>Terraform apply</code> creates the resource specified in the .tf files. Initially the same output as in the <code>terraform plan</code> step is shown (hence its <em>dry run</em>). The output further states which resources are added, which will be changed, and which resources will be destroyed. After confirming the actions the resource creation will be executed.</p>
<p>If there have been made changes in the terraform ressources and those changes should be applied, <code>terraform apply</code> can be performed again as it is shown that resources will be changed.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="terraform.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">terraform</span> apply — Makes the changes in the infrastructure as defined in the plan</span></code></pre></div>
</div>
<div id="terraform-destroy" class="section level3 hasAnchor" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> terraform destroy<a href="terraform.html#terraform-destroy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, to destoy all created ressouces and to delete everything we did before, there is the <code>terraform destroy</code> command.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="terraform.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">terraform</span> destroy — Deletes all the old infrastructure resources</span></code></pre></div>
</div>
</div>
<div id="core-concepts" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Core Concepts<a href="terraform.html#core-concepts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="state" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> State<a href="terraform.html#state" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="providers" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> providers<a href="terraform.html#providers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Terraform relies on plugins called providers to interact with cloud providers, SaaS providers, and other APIs.</p>
<p>Each provider adds a set of resource types and/or data sources that Terraform can manage.</p>
<p>provider. chose cloud</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="terraform.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">provider</span> <span class="st">&quot;aws&quot;</span> {</span>
<span id="cb7-2"><a href="terraform.html#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">region</span> = <span class="st">&quot;us-east-1&quot;</span></span>
<span id="cb7-3"><a href="terraform.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span></code></pre></div>
</div>
<div id="resources" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Resources<a href="terraform.html#resources" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="terraform.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">resource</span> <span class="st">&quot;aws_instance&quot;</span> <span class="st">&quot;my-instance&quot;</span> {</span>
<span id="cb8-2"><a href="terraform.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">ami</span>           = <span class="st">&quot;ami-0ddbdea833a8d2f0d&quot;</span></span>
<span id="cb8-3"><a href="terraform.html#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="ex">instance_type</span> = <span class="st">&quot;t2.micro&quot;</span></span>
<span id="cb8-4"><a href="terraform.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-5"><a href="terraform.html#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="ex">tags</span> = {</span>
<span id="cb8-6"><a href="terraform.html#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Name</span> = <span class="st">&quot;my-instance&quot;</span></span>
<span id="cb8-7"><a href="terraform.html#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ManagedBy</span> = <span class="st">&quot;Terraform&quot;</span></span>
<span id="cb8-8"><a href="terraform.html#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="er">}</span></span>
<span id="cb8-9"><a href="terraform.html#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span></code></pre></div>
</div>
<div id="data-sources" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Data Sources<a href="terraform.html#data-sources" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="input-variables" class="section level3 hasAnchor" number="3.3.5">
<h3><span class="header-section-number">3.3.5</span> Input Variables<a href="terraform.html#input-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="output-variables" class="section level3 hasAnchor" number="3.3.6">
<h3><span class="header-section-number">3.3.6</span> Output Variables<a href="terraform.html#output-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="local-variables" class="section level3 hasAnchor" number="3.3.7">
<h3><span class="header-section-number">3.3.7</span> Local Variables<a href="terraform.html#local-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="modules" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Modules<a href="terraform.html#modules" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="language" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Language<a href="terraform.html#language" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Input Variables — Serve as parameters for a Terraform module, so users can customize behavior without editing the source
Modules — Acts as a container for multiple resources that are used together. It is a way to package and reuse resource configurations.
Resources — Documents the syntax for declaring resources
Data sources — Allow data to be fetched or computed for use elsewhere in Terraform configuration
Output values — Return values for a Terraform module
Local values — A convenience feature for assigning a short name to an expression</p>
</div>
<div id="additionals" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> additionals<a href="terraform.html#additionals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="count-and-for_each-meta-arguments" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> count and for_each Meta Arguments<a href="terraform.html#count-and-for_each-meta-arguments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="workspaces" class="section level3 hasAnchor" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> workspaces<a href="terraform.html#workspaces" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="full-example---building-ec2-and-s3" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Full example - building ec2 and s3<a href="terraform.html#full-example---building-ec2-and-s3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://www.baeldung.com/ops/terraform-intro" class="uri">https://www.baeldung.com/ops/terraform-intro</a></p>
<div class="figure">
<img src="images/04-Kubernetes/k8s-cluster.png" alt="" />
<p class="caption">K8s Cluster</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="architecture.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/seblum/kubernetes-training/edit/master/02-Terraform.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
